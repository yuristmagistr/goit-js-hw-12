{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport axios from 'axios';\n\nconst form = document.querySelector('.form');\nconst gallery = document.querySelector('.gallery');\nconst input = document.querySelector('input');\nconst loadMoreBtn = document.querySelector('.load_button');\nconst loader = document.querySelector('.loader');\n\nlet page;\nlet searchTerm = '';\nlet maxPage = 1;\n\nform.addEventListener('submit', onCreateFormSubmit);\nloadMoreBtn.addEventListener('click', onLoadMoreItems);\n\nasync function onCreateFormSubmit(event) {\n  event.preventDefault();\n  searchTerm = input.value.trim();\n  page = 1;\n\n  if (!searchTerm) {\n    return iziToast.error({\n      message: 'Please enter a search query.',\n      position: 'topRight',\n    });\n  }\n\n  gallery.innerHTML = '';\n\n  try {\n    await fetchImages();\n  } catch (error) {\n    console.error(error);\n    iziToast.error({\n      message:\n        'An error occurred while fetching images. Please try again later.',\n      position: 'topRight',\n    });\n  }\n\n  event.target.reset();\n}\n\nasync function onLoadMoreItems() {\n  page += 1;\n\n  try {\n    await fetchImages();\n  } catch (error) {\n    console.error(error);\n    iziToast.error({\n      message:\n        'An error occurred while fetching images. Please try again later.',\n      position: 'topRight',\n    });\n  }\n\n  const height = gallery.firstElementChild.getBoundingClientRect().height;\n\n  window.scrollBy({\n    top: height * 2,\n    behavior: 'smooth',\n  });\n}\n\nasync function fetchImages() {\n  showLoader();\n  checkBtnVisibleStatus();\n  const apiKey = '42435479-889f1388d96929484f40a1796';\n  const perPage = 15;\n  const url = `https://pixabay.com/api/?key=${apiKey}&q=${searchTerm}&image_type=photo&orientation=horizontal&safesearch=true&page=${page}&per_page=${perPage}`;\n\n  try {\n    const response = await axios.get(url);\n    const data = response.data;\n    maxPage = Math.ceil(data.totalHits / perPage) || 1;\n    if (data.hits.length === 0) {\n      iziToast.error({\n        message:\n          'Sorry, there are no images matching <br/>your search query. Please try again!',\n        position: 'topRight',\n      });\n    } else {\n      const markup = data.hits\n        .map(hits => {\n          return `<li class=\"gallery-item\" >\n    <a class=\"gallery-link\" href=\"${hits.largeImageURL}\">\n      <img\n        class=\"gallery-image\"\n        src=\"${hits.webformatURL}\"\n        alt=\"${hits.tags}\"\n      />\n    </a>\n    <div class=\"item-text\">\n      <ul>Likes<li>${hits.likes}</li></ul>\n      <ul>Views<li>${hits.views}</li></ul>\n      <ul>Comments<li>${hits.comments}</li></ul>\n      <ul>Downloads<li>${hits.downloads}</li></ul>\n    </div>\n  </li>`;\n        })\n        .join('');\n      gallery.insertAdjacentHTML('beforeend', markup);\n      const lightbox = new SimpleLightbox('.gallery a', {\n        captions: true,\n        captionType: 'attr',\n        captionsData: 'alt',\n        captionPosition: 'bottom',\n        fadeSpeed: 150,\n        captionSelector: 'img',\n        captionDelay: 250,\n      });\n      lightbox.on('show.simplelightbox').refresh();\n      hideLoader();\n\n      if (page >= maxPage) {\n        iziToast.info({\n          message: \"We're sorry, but you've reached the end of search results.\",\n          position: 'topRight',\n        });\n      }\n    }\n  } catch (error) {\n    throw new Error(error.message);\n  }\n\n  checkBtnVisibleStatus();\n}\n\nfunction showLoader() {\n  loader.style.display = 'inline-block';\n}\n\nfunction hideLoader() {\n  loader.style.display = 'none';\n}\n\nfunction showLoadBtn() {\n  loadMoreBtn.classList.remove('hidden');\n}\n\nfunction hideLoadBtn() {\n  loadMoreBtn.classList.add('hidden');\n}\n\nfunction checkBtnVisibleStatus() {\n  if (page >= maxPage) {\n    hideLoadBtn();\n  } else {\n    showLoadBtn();\n  }\n}"],"names":["form","gallery","input","loadMoreBtn","loader","page","searchTerm","maxPage","onCreateFormSubmit","onLoadMoreItems","event","iziToast","fetchImages","error","height","showLoader","checkBtnVisibleStatus","apiKey","perPage","url","data","axios","markup","hits","SimpleLightbox","hideLoader","showLoadBtn","hideLoadBtn"],"mappings":"owBAQA,MAAMA,EAAO,SAAS,cAAc,OAAO,EACrCC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAQ,SAAS,cAAc,OAAO,EACtCC,EAAc,SAAS,cAAc,cAAc,EACnDC,EAAS,SAAS,cAAc,SAAS,EAE/C,IAAIC,EACAC,EAAa,GACbC,EAAU,EAEdP,EAAK,iBAAiB,SAAUQ,CAAkB,EAClDL,EAAY,iBAAiB,QAASM,CAAe,EAErD,eAAeD,EAAmBE,EAAO,CAKvC,GAJAA,EAAM,eAAc,EACpBJ,EAAaJ,EAAM,MAAM,OACzBG,EAAO,EAEH,CAACC,EACH,OAAOK,EAAS,MAAM,CACpB,QAAS,+BACT,SAAU,UAChB,CAAK,EAGHV,EAAQ,UAAY,GAEpB,GAAI,CACF,MAAMW,EAAW,CAClB,OAAQC,EAAO,CACd,QAAQ,MAAMA,CAAK,EACnBF,EAAS,MAAM,CACb,QACE,mEACF,SAAU,UAChB,CAAK,CACF,CAEDD,EAAM,OAAO,OACf,CAEA,eAAeD,GAAkB,CAC/BJ,GAAQ,EAER,GAAI,CACF,MAAMO,EAAW,CAClB,OAAQC,EAAO,CACd,QAAQ,MAAMA,CAAK,EACnBF,EAAS,MAAM,CACb,QACE,mEACF,SAAU,UAChB,CAAK,CACF,CAED,MAAMG,EAASb,EAAQ,kBAAkB,sBAAqB,EAAG,OAEjE,OAAO,SAAS,CACd,IAAKa,EAAS,EACd,SAAU,QACd,CAAG,CACH,CAEA,eAAeF,GAAc,CAC3BG,IACAC,IACA,MAAMC,EAAS,qCACTC,EAAU,GACVC,EAAM,gCAAgCF,CAAM,MAAMX,CAAU,iEAAiED,CAAI,aAAaa,CAAO,GAE3J,GAAI,CAEF,MAAME,GADW,MAAMC,EAAM,IAAIF,CAAG,GACd,KAEtB,GADAZ,EAAU,KAAK,KAAKa,EAAK,UAAYF,CAAO,GAAK,EAC7CE,EAAK,KAAK,SAAW,EACvBT,EAAS,MAAM,CACb,QACE,gFACF,SAAU,UAClB,CAAO,MACI,CACL,MAAMW,EAASF,EAAK,KACjB,IAAIG,GACI;AAAA,oCACmBA,EAAK,aAAa;AAAA;AAAA;AAAA,eAGvCA,EAAK,YAAY;AAAA,eACjBA,EAAK,IAAI;AAAA;AAAA;AAAA;AAAA,qBAIHA,EAAK,KAAK;AAAA,qBACVA,EAAK,KAAK;AAAA,wBACPA,EAAK,QAAQ;AAAA,yBACZA,EAAK,SAAS;AAAA;AAAA,QAG9B,EACA,KAAK,EAAE,EACVtB,EAAQ,mBAAmB,YAAaqB,CAAM,EAC7B,IAAIE,EAAe,aAAc,CAChD,SAAU,GACV,YAAa,OACb,aAAc,MACd,gBAAiB,SACjB,UAAW,IACX,gBAAiB,MACjB,aAAc,GACtB,CAAO,EACQ,GAAG,qBAAqB,EAAE,QAAO,EAC1CC,IAEIpB,GAAQE,GACVI,EAAS,KAAK,CACZ,QAAS,6DACT,SAAU,UACpB,CAAS,CAEJ,CACF,OAAQE,EAAO,CACd,MAAM,IAAI,MAAMA,EAAM,OAAO,CAC9B,CAEDG,GACF,CAEA,SAASD,GAAa,CACpBX,EAAO,MAAM,QAAU,cACzB,CAEA,SAASqB,GAAa,CACpBrB,EAAO,MAAM,QAAU,MACzB,CAEA,SAASsB,GAAc,CACrBvB,EAAY,UAAU,OAAO,QAAQ,CACvC,CAEA,SAASwB,GAAc,CACrBxB,EAAY,UAAU,IAAI,QAAQ,CACpC,CAEA,SAASa,GAAwB,CAC3BX,GAAQE,EACVoB,IAEAD,GAEJ"}